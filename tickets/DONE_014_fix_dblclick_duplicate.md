# 014: ダブルクリック描画完了時に重複ノードが追加されるバグの修正

## 種別
バグ修正

## 問題
描画中にダブルクリックで描画を完了すると、終点に同一座標のノードが2つ重なり、距離0pxのエッジが表示される。

## 原因
ブラウザのイベント発火順序は `click` → `click` → `dblclick`。
現在の実装では `dblclick` ハンドラで `skipNextClick.current = true` を設定しているが、これはダブルクリック**後**のクリックをスキップするためのもので、ダブルクリック自体の2回目の `click` イベントには間に合わない。

結果:
1. 1回目の `click` → ノード追加 ✓
2. 2回目の `click` → 同じ座標にノード追加 ← **これが問題**
3. `dblclick` → `skipNextClick = true` + `setDrawMode("idle")`

## 修正方針
ダブルクリックの2回目の `click` で追加されたノードを除去する。`handleDblClick` 内で:

1. `setDrawMode("idle")` する前に、アクティブパスの末尾2ノードが同一座標かチェック
2. 同一座標なら `undoLastNode(activePathId)` で末尾ノードを削除
3. その後 `setDrawMode("idle")`

あるいは、よりシンプルなアプローチとして:
- `handleDblClick` 内で常に `undoLastNode` を呼び、ダブルクリックの2回目で追加されたノードを取り消す

どちらの方法でも可。重複ノードが残らなければよい。

## 完了条件
1. ダブルクリックで描画完了したとき、終点にノードが重複しない
2. ダブルクリック後のパスの末尾エッジが0pxにならない
3. 1ノードだけの状態でダブルクリックしても問題が発生しない（パスが消えるか、描画が完了するか、どちらでもよいが安全に動作すること）
4. `npm run build` がエラーなく通る
5. `npm run lint` がエラーなく通る

## コミット
完了条件を満たしたら `tickets/README.md` の「コミット手順」に従いコミット。
コミットメッセージ: `ticket-014: fix duplicate node on double-click`
